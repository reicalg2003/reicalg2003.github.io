"use strict";(self.webpackChunkreicalg=self.webpackChunkreicalg||[]).push([[515],{4919:(e,o,l)=>{l.r(o),l.d(o,{data:()=>t});const t={key:"v-cea7c3b6",path:"/web/web4.html",title:"文件包含刷题",lang:"zh-CN",frontmatter:{date:"2023/5/29 19:57",stick:!1,keyword:"misc,ctfshow",description:"刷题",title:"文件包含刷题",tag:["ctfshow刷题"],categories:["文件包含","歪比八卜"]},excerpt:"",headers:[{level:2,title:"文件包含",slug:"文件包含",children:[{level:3,title:"web78",slug:"web78",children:[]},{level:3,title:"Web79",slug:"web79",children:[]},{level:3,title:"Web80",slug:"web80",children:[]},{level:3,title:"Web81",slug:"web81",children:[]}]}],git:{}}},3799:(e,o,l)=>{l.r(o),l.d(o,{default:()=>w});var t=l(6252);const p=(0,t._)("h2",{id:"文件包含",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#文件包含","aria-hidden":"true"},"#"),(0,t.Uk)(" 文件包含")],-1),c=(0,t._)("h3",{id:"web78",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#web78","aria-hidden":"true"},"#"),(0,t.Uk)(" web78")],-1),a=(0,t._)("p",null,[(0,t._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230530144343183",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305301443215.png",data:"aurora"})],-1),i=(0,t._)("blockquote",null,[(0,t._)("p",null,"文件包含常规题 考虑伪协议绕过 这道题没有啥过滤的直接读就行"),(0,t._)("p",null,"payload："),(0,t._)("p",null,"（1）?file=data://text/plain;base64,PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==（base64过后的<?php eval($_POST[1]);）"),(0,t._)("p",null,'POST ：1=system("cat * f *");'),(0,t._)("p",null,"（2）?file=php://filter/convert.base64-encode/resource=flag.php")],-1),n=(0,t._)("h3",{id:"web79",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#web79","aria-hidden":"true"},"#"),(0,t.Uk)(" Web79")],-1),u=(0,t._)("p",null,[(0,t._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"img",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305301352058.png",data:"aurora"})],-1),b=(0,t.uE)('<blockquote><p>该题目意思是将php replace成？？？所以无法直接包含flag.php</p><p>这边可以使用data伪协议绕过</p></blockquote><blockquote><p>1.data协议</p></blockquote><blockquote><p>php5.2.0起，数据流封装器开始有效，主要用于数据流的读取。如果传入的数据是PHP代码，就会执行代码</p></blockquote><blockquote><p>使用方法:data://text/plain;base64,xxxx(base64编码后的数据)</p></blockquote><blockquote><p>data伪协议只有在php&lt;5.3且include=on时可以写木马。</p></blockquote><blockquote><p>2.php伪协议：</p></blockquote><blockquote><p>需要开启allow_url_fopen的：php://input（post请求提交数据）、php://stdin、php://memory和php://temp</p></blockquote><blockquote><p>不需要开启allow_wrl_fopen的：php://filter 用于读取源码</p></blockquote><blockquote><p>经常使用的是php://filter 用于读取源码 和php://input 用于执行php代码</p></blockquote><h3 id="web80" tabindex="-1"><a class="header-anchor" href="#web80" aria-hidden="true">#</a> Web80</h3>',10),s=(0,t._)("p",null,[(0,t._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"img",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305301352092.png",data:"aurora"})],-1),r=(0,t.uE)('<blockquote><p>data 和 php 被过滤所以data和伪协议用不了</p></blockquote><blockquote><p>用包含日志文件方法 大概意思就是</p><p>1、日志的默认路径</p></blockquote><blockquote><p>/etc/httpd/logs/access_log或/var/log/httpd/access_log //apache+linux</p></blockquote><blockquote><p>nginx 日志文件在用户安装目录的logs目录下/var/log/nginx/access.log</p></blockquote><blockquote><p>2、web中间件默认配置uoh文件</p></blockquote><blockquote><p>/etc/httpd/conf/httpd.conf或index.php?page=/etc/init.d/httpd //apache+linux</p></blockquote><blockquote><p>C:/Windows/system32/inetsrv/metabase.xml //iis6.0+win2003</p></blockquote><blockquote><p>C:WindowsSystem32inetsrvconfigapplicationHost.config //iis7.0+win</p></blockquote><blockquote><p>3、利用</p></blockquote><blockquote><p>方法1 访问</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>http://www.xx.com/&lt;?php phpinfo(); ?&gt;时，&lt;?php phpinfo(); ?&gt;也会被记录在日志里，也可以插入到User-Agent；但是在日志里这句话被编码了；所以用Burp Suite修改来绕过编码；然后包含相应的日志文件：\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></blockquote><blockquote><p>/var/log/nginx/access.log找到日志文件，并以php解析的方式打开</p></blockquote><blockquote><p>方法2 可以添加php语句 到user_agent（User Agent中文名为用户代理，是Http协议中的一部分，属于头域的组成部分，User Agent也简称UA。它是一个特殊字符串头，是一种向访问网站提供你所使用的浏览器类型及版本、操作系统及版本、浏览器内核、等信息的标识。通过这个标 识，用户所访问的网站可以显示不同的排版从而为用户提供更好的体验或者进行信息统计；例如用手机访问谷歌和电脑访问是不一样的，这些是谷歌根据访问者的 UA来判断的。）中</p></blockquote>',12),g=(0,t._)("p",null,[(0,t._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230530153049671",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305301530825.png",data:"aurora"})],-1),h=(0,t._)("h3",{id:"web81",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#web81","aria-hidden":"true"},"#"),(0,t.Uk)(" Web81")],-1),d=(0,t._)("p",null,[(0,t._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"img",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305301352097.png",data:"aurora"})],-1),k=(0,t._)("blockquote",null,[(0,t._)("p",null,"多过滤了：不影响包含日志文件的尝试用上一题解决方法")],-1),m=(0,t._)("p",null,[(0,t._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"img",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305301352122.png",data:"aurora"})],-1),q=(0,t._)("blockquote",null,[(0,t._)("p",null,"一般都是能够通过日志包含来写的")],-1),_={},w=(0,l(3744).Z)(_,[["render",function(e,o){return(0,t.wg)(),(0,t.iD)(t.HY,null,[p,c,a,i,n,u,b,s,r,g,h,d,k,m,q],64)}]])}}]);