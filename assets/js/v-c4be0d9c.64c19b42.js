"use strict";(self.webpackChunkreicalg=self.webpackChunkreicalg||[]).push([[278],{6293:(l,i,n)=>{n.r(i),n.d(i,{data:()=>a});const a={key:"v-c4be0d9c",path:"/misc/1.html",title:"misc刷题（杂七杂八）",lang:"zh-CN",frontmatter:{date:"2023/7/10 16:18",stick:!1,keyword:"misc",description:"刷题",title:"misc刷题（杂七杂八）",tag:["ctfshow刷题"],categories:["misc","歪比八卜"]},excerpt:"",headers:[{level:2,title:"[CISCN 2022 初赛]ez_usb",slug:"ciscn-2022-初赛-ez-usb",children:[]},{level:2,title:"[CISCN 2018]Picture",slug:"ciscn-2018-picture",children:[]},{level:2,title:"[CISCN 2023 初赛]被加密的生产流量",slug:"ciscn-2023-初赛-被加密的生产流量",children:[]},{level:2,title:"[CISCN 2022 初赛]everlasting_night",slug:"ciscn-2022-初赛-everlasting-night",children:[]},{level:2,title:"[CISCN 2021初赛]running_pixel",slug:"ciscn-2021初赛-running-pixel",children:[]}],git:{}}},1443:(l,i,n)=>{n.r(i),n.d(i,{default:()=>kl});var a=n(6252);const o=(0,a._)("h2",{id:"ciscn-2022-初赛-ez-usb",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#ciscn-2022-初赛-ez-usb","aria-hidden":"true"},"#"),(0,a.Uk)(" [CISCN 2022 初赛]ez_usb")],-1),c=(0,a._)("p",null,"这道题已经提示是一道usb流量分析题",-1),g={href:"https://blog.51cto.com/u_15400016/4288275",target:"_blank",rel:"noopener noreferrer"},t=(0,a.Uk)("USB流量取证分析"),r=(0,a.Uk)("HID（Human Interface Device，人机接口设备）是USB设备中常用的"),p={href:"https://www.usbzh.com/article/detail-273.html",target:"_blank",rel:"noopener noreferrer"},s=(0,a.Uk)("设备类型"),e=(0,a.Uk)("，是直接与人交互的USB设备，例如键盘、鼠标与游戏杆等。在USB设备中，HID设备的成本较低。另外，HID设备并不一定要有人机交互功能，只要符合HID类别规范的设备都是HID设备。"),u=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230724172358412",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307241723667.png",data:"aurora"})],-1),m=(0,a._)("p",null,"usbhid.data先筛选有hid的流量 一般来讲是键盘、鼠标、游戏杆",-1),_=(0,a._)("p",null,"有三组2.8.1 ，2.4.1，2.10.1",-1),d=(0,a._)("p",null,"分别把他们重组",-1),b=(0,a._)("p",null,"2.4.1的流量包中包数据长度为0 应该是一个混淆包",-1),h=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725083740988",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307250837270.png",data:"aurora"})],-1),z=(0,a._)("p",null,"一般usb流量隐写，要么键盘隐写，或者是鼠标隐写",-1),y=(0,a._)("p",null,"将其放入usb键盘鼠标流量脚本跑 此处使用的是",-1),f=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725084033262",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307250840287.png",data:"aurora"})],-1),j=(0,a._)("blockquote",null,[(0,a._)("p",null,"2.8.1")],-1),v=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725084009040",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307250840080.png",data:"aurora"})],-1),S=(0,a._)("p",null,"将其中的CAP和DEL删除",-1),k=(0,a._)("div",{class:"language-text ext-text line-numbers-mode"},[(0,a._)("pre",{class:"language-text"},[(0,a._)("code",null,"JPEG文件头FFD8FFE0 00104A46,JPEG文件结尾为FFD9,rar的文件尾C43D7B00 400700,文件头52617221 1A0700即Rar!,ZIP文件头504B0304 0A00即PK,GIF开头`47494638 396即GIF,PNG文件头89504E47 0D0A1A0A 0000000D 49即|PNG,PNG文件结尾49454E44 AE426082即IEND bmp文件头424D即BM\n")]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br")])],-1),C=(0,a._)("p",null,"文件头显示是rar文件，导入010editor 重新导出文件 （注意代码块十六进制需要ctrl+shift+v整段复制）",-1),q=(0,a._)("blockquote",null,[(0,a._)("p",null,"2.10.1")],-1),I=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307250845852.png",data:"aurora"})],-1),x=(0,a._)("p",null,"这个猜测是rar文件密码",-1),D=(0,a._)("h2",{id:"ciscn-2018-picture",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#ciscn-2018-picture","aria-hidden":"true"},"#"),(0,a.Uk)(" [CISCN 2018]Picture")],-1),N=(0,a._)("p",null,"拿到题目首先想着binwalk分离文件",-1),U=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725100342848",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307251003939.png",data:"aurora"})],-1),w=(0,a._)("p",null,"分离以后文件发现文件有base64编码可能",-1),P=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725100758799",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307251007833.png",data:"aurora"})],-1),E=(0,a._)("p",null,"这边我先解了一遍",-1),A=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725101417193",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307251014228.png",data:"aurora"})],-1),B=(0,a._)("p",null,"kp开头中间也有pk 考点是文件头混肴，但是这个没法直接换成十六进制",-1),F=(0,a.Uk)("可以使用在线工具"),G={href:"https://base64.us/",target:"_blank",rel:"noopener noreferrer"},H=(0,a.Uk)("Base64 在线编码解码 "),W=(0,a._)("p",null,"直接换成十六进制导入010editor然后修改文件头导出zip文件",-1),J=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725102139482",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307251021568.png",data:"aurora"})],-1),L=(0,a._)("p",null,"注释中<- password啊是提示 然后根据前面的报错提示可以得到密码： integer division or modulo by zero",-1),Z=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725102327781",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307251023848.png",data:"aurora"})],-1),K=(0,a._)("p",null,"解压文件得到俩文件 一个假flag 另一个文件是编码",-1),M=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725102808612",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307251028642.png",data:"aurora"})],-1),R=(0,a._)("p",null,"直接扔工具里面去跑了",-1),Y=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725102923662",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307251029722.png",data:"aurora"})],-1),O=(0,a._)("p",null,"是uuencode编码",-1),Q=(0,a._)("h2",{id:"ciscn-2023-初赛-被加密的生产流量",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#ciscn-2023-初赛-被加密的生产流量","aria-hidden":"true"},"#"),(0,a.Uk)(" [CISCN 2023 初赛]被加密的生产流量")],-1),T=(0,a._)("p",null,"流量包的名字就是modbus 猜测与modbus有关 追踪tcp流 看隐写的内容",-1),V=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725111431413",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307251114676.png",data:"aurora"})],-1),X=(0,a._)("p",null,"有等号是base编码 可以使用pyshark脚本跑切割，或者就是手动一个一个写下来这个",-1),$=(0,a._)("p",null,"放进解码器跑就行了",-1),ll=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230725141828416",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307251418825.png",data:"aurora"})],-1),il=(0,a._)("h2",{id:"ciscn-2022-初赛-everlasting-night",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#ciscn-2022-初赛-everlasting-night","aria-hidden":"true"},"#"),(0,a.Uk)(" [CISCN 2022 初赛]everlasting_night")],-1),nl=(0,a._)("p",null,"一道lsb隐写题",-1),al=(0,a._)("p",null,"首先打开010editor 查看这张png图片的hex 文件头和文件尾是全的 文件尾之后还有一串十六进制",-1),ol=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230728110233535",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307281102581.png",data:"aurora"})],-1),cl=(0,a._)("p",null,"32位 ？？？ md5 解密",-1),gl=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230728110753829",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307281107876.png",data:"aurora"})],-1),tl=(0,a._)("p",null,"ohhWh04m1 不知道是什么东西 先留着再说",-1),rl=(0,a._)("p",null,"stegsolve 打开图片 发现在alpha 通道2里面发现一点不对",-1),pl=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230728111136364",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307281111490.png",data:"aurora"})],-1),sl=(0,a._)("p",null,"用data extract 打开alpha通道通道2 以列",-1),el=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230728111757955",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307281117018.png",data:"aurora"})],-1),ul=(0,a._)("p",null,"是有一串字符串的 还是不知道要用来干什么",-1),ml=(0,a._)("p",null,"学lsb隐写 那就跑脚本了 上面的字符串是lsb隐写的密码",-1),_l=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230728112352233",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307281123269.png",data:"aurora"})],-1),dl=(0,a._)("p",null,"先导了一份文本文件，pk文件头 导一份zip出来",-1),bl=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230728112306789",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307281123857.png",data:"aurora"})],-1),hl=(0,a._)("p",null,"zip解压缩有密码，拿第一个密码解压 出了一个flag文件 看格式应该是png 但是文件损坏",-1),zl=(0,a._)("p",null,"看wp 需要用gimp打开 并且需要改一下后缀名为data",-1),yl=(0,a._)("p",null,[(0,a._)("code",null,"gimp flag.data")],-1),fl=(0,a._)("p",null,"改一点宽度 就出来了",-1),jl=(0,a._)("p",null,[(0,a._)("img",{src:"https://ooszy.cco.vin/img/blog-public/ljz.gif",alt:"image-20230728112729732",originSrc:"https://blog-1318287398.cos.ap-nanjing.myqcloud.com/img/202307281127822.png",data:"aurora"})],-1),vl=(0,a._)("h2",{id:"ciscn-2021初赛-running-pixel",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#ciscn-2021初赛-running-pixel","aria-hidden":"true"},"#"),(0,a.Uk)(" [CISCN 2021初赛]running_pixel")],-1),Sl={},kl=(0,n(3744).Z)(Sl,[["render",function(l,i){const n=(0,a.up)("ExternalLinkIcon");return(0,a.wg)(),(0,a.iD)(a.HY,null,[o,c,(0,a._)("p",null,[(0,a._)("a",g,[t,(0,a.Wm)(n)])]),(0,a._)("blockquote",null,[(0,a._)("p",null,[r,(0,a._)("a",p,[s,(0,a.Wm)(n)]),e])]),u,m,_,d,b,h,z,y,f,j,v,S,k,C,q,I,x,D,N,U,w,P,E,A,B,(0,a._)("p",null,[F,(0,a._)("a",G,[H,(0,a.Wm)(n)])]),W,J,L,Z,K,M,R,Y,O,Q,T,V,X,$,ll,il,nl,al,ol,cl,gl,tl,rl,pl,sl,el,ul,ml,_l,dl,bl,hl,zl,yl,fl,jl,vl],64)}]])}}]);